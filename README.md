# Проект стажировки IT_ONE - Система оплаты картой

## Цель проекта
1. Разработать серверную часть системы оплаты картой на микросервисной архитектуре, реализуя паттерн API FIRST.  
2. Протестировать и обернуть инфраструктуру системы в контейнеры общей сети **Docker**.

## Архитектура системы
Основные микросервисы:
1. **payment-gateway** — принимает HTTP POST запросы на оплату.
2. **card-validation** — проверяет корректность введённых данных карты.
3. **bank-payment** — выполняет авторизацию платежа в банке.
4. **payment-processing** — формирует финальный статус транзакции.
5. **transaction-recording** — сохраняет данные транзакций в БД.
6. **notification-service** — отправляет email-уведомления о статусе транзакции (имитация через MailHog).
7. **logging-service** — собирает логи всех операций и сохраняет их в БД.

Внешние системы и интеграции:
- **RabbitMQ** — брокер сообщений для обмена данными между микросервисами.
- **Postgres** — SQL БД для хранения данных транзакций и логов.
- **MailHog** — локальный SMTP-сервер для имитации отправки email-писем.

## Сценарий работы системы:
1. Клиент отправляет **HTTP POST** запрос на `payment-gateway` c банковскими данными по URI `/payment/authoriize`.
2. `payment-gateway` через **RabbitMQ** вызывает `card-validation` для проверки данных карты.
3. `card-validation` возвращает результат (валидные данные / ошибка).
4. `payment-gateway` отвечает клиенту:  
   - ошибка в данных → вернуть сообщение «Введите данные корректно»;  
   - успех → «Платёж принят в обработку».
5. Далее `payment-gateway` отправляет данные в `bank-payment` для авторизации.
6. `bank-payment` проверяет сумму платежа и возвращает результат в `payment-processing`.
7. `payment-processing` формирует финальный статус транзакции и отправляет:  
   - в `transaction-recording` → событие о необходимости записи данных в БД;  
   - в `notification-service` → уведомление о необходимости отправки email-письма.
8. `notification-service` через MailHog имитирует отправку письма на email, указанный клиентом.
9. Все сервисы параллельно отправляют **логи событий** в `logging-service`, который сохраняет их в БД.

## Схема компонентов системы
![Схема компонентов](https://github.com/user-attachments/assets/4b421ae6-32fd-4234-8bd8-b40570a4c85b)

## Контейнеризация
Вся система запускается внутри **Docker Compose**:
- каждый микросервис — отдельный контейнер;
- общая сеть `docker-compose` связывает сервисы;
- RabbitMQ, Postgres и MailHog поднимаются как инфраструктурные контейнеры;
- можно запускать всю систему одной командой:

```bash
docker-compose up -d
